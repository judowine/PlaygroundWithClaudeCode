# PBI作成ワークフロー

## 概要

このドキュメントは、ステークホルダーからのヒアリングから Product Backlog Item (PBI) の作成まで完全なワークフローを定義します。Kotlin Multiplatform プロジェクト（Android、iOS、Web、Desktop、Server）における効率的な要件管理プロセスを実現します。

## 1. ステークホルダーヒアリングのプロセス

### 1.1 事前準備

#### ヒアリング前の準備事項
- **ステークホルダー情報の収集**
  - 役職・責任範囲
  - 技術的理解レベル
  - 過去の要求パターン
  - 優先順位付けの傾向

- **現状把握**
  - 既存システムの機能
  - 技術的制約
  - 開発チームのキャパシティ
  - リリース計画

#### 準備資料
- システム概要資料
- 技術アーキテクチャ図
- 現在のロードマップ
- 過去のPBI実績

### 1.2 ヒアリング実施

#### 構造化質問フレームワーク

**1. 背景・動機の理解**
- 「なぜこの機能が必要になったのですか？」
- 「現在どのような課題がありますか？」
- 「期待している成果は何ですか？」

**2. ユーザー・シナリオの特定**
- 「この機能を使うユーザーは誰ですか？」
- 「どのような状況で使用されますか？」
- 「ユーザーの典型的な行動パターンはどうなりますか？」

**3. 成功指標の定義**
- 「この機能が成功したかどうかはどう判断しますか？」
- 「測定可能な指標はありますか？」
- 「どの程度の改善を期待していますか？」

**4. 制約・条件の確認**
- 「希望するリリース時期はありますか？」
- 「予算的な制約はありますか？」
- 「必須の要件と希望的な要件を教えてください」

**5. プラットフォーム要件の確認**
- 「どのプラットフォームでの対応が必要ですか？」
  - Android: スマートフォン・タブレット
  - iOS: iPhone・iPad
  - Web: デスクトップ・モバイルブラウザ
  - Desktop: Windows・Mac・Linux
  - Server: API・バックエンド処理

#### ヒアリング実施のベストプラクティス

- **アクティブリスニング**
  - 相手の話を最後まで聞く
  - 理解した内容を要約して確認する
  - 曖昧な表現は具体化を促す

- **具体例の活用**
  - 「例えば〜」を多用して具体的なシナリオを引き出す
  - スケッチやワイヤーフレームを活用
  - 既存システムとの比較で説明

- **技術的実現可能性の初期評価**
  - 明らかに実現困難な要求については早期に議論
  - 技術的選択肢とトレードオフの説明
  - 段階的実装の可能性を提案

## 2. 要件の整理と分析

### 2.1 ヒアリング結果の構造化

#### 情報の分類・整理
```
要件情報シート
├── 基本情報
│   ├── ステークホルダー情報
│   ├── 要求の背景・動機
│   └── 期限・制約条件
├── 機能要件
│   ├── 必須機能
│   ├── 希望機能
│   └── 将来的な拡張性
├── 非機能要件
│   ├── パフォーマンス
│   ├── セキュリティ
│   ├── 使いやすさ
│   └── 運用・保守性
└── プラットフォーム要件
    ├── 対象プラットフォーム
    ├── プラットフォーム固有要件
    └── 共通機能要件
```

### 2.2 要件分析・優先度付け

#### MoSCoW分析
- **Must have（必須）**: システム成功に不可欠
- **Should have（重要）**: 重要だが必須ではない
- **Could have（希望）**: あれば嬉しい機能
- **Won't have（対象外）**: 今回は実装しない

#### プラットフォーム影響度分析
各要件について以下を評価：
- **実装難易度**: Low（L）/ Medium（M）/ High（H）
- **影響範囲**: 単一プラットフォーム / 複数プラットフォーム / 全プラットフォーム
- **技術的リスク**: プラットフォーム固有の制約や技術的課題

### 2.3 技術的実現可能性の検討

#### 技術検討事項
- **共通ロジックの範囲**: shared モジュールで実装可能な範囲
- **プラットフォーム固有実装**: expect/actual での実装が必要な部分
- **UI/UX統一性**: Compose Multiplatform での実現可能性
- **パフォーマンス要件**: 各プラットフォームでの性能制約
- **外部連携**: API・SDKの利用可能性

## 3. ユーザーストーリーの作成

### 3.1 ユーザーペルソナの特定

#### ペルソナ設定項目
- **基本情報**: 年齢、職業、技術習熟度
- **利用環境**: 主に使用するプラットフォーム、デバイス
- **行動パターン**: システム利用頻度、時間帯
- **ニーズ・課題**: 解決したい問題、期待する価値

#### 主要ペルソナ例
- **エンドユーザー**: アプリの主要利用者
- **管理者**: システム管理・設定を行う人
- **開発者**: API利用やシステム連携を行う人

### 3.2 ユーザーストーリー作成

#### ストーリー作成テンプレート
```
As a [ユーザータイプ/ペルソナ]
I want [実現したい機能・行動]
So that [得られる価値・解決される課題]
```

#### 良いユーザーストーリーの特徴（INVEST原則）
- **Independent（独立性）**: 他のストーリーに依存しない
- **Negotiable（交渉可能）**: 実装方法について議論の余地がある
- **Valuable（価値がある）**: ユーザーに明確な価値を提供
- **Estimable（見積可能）**: 開発工数が見積もれる
- **Small（小さい）**: 1-2スプリントで完了可能
- **Testable（テスト可能）**: 完了を判定できる

#### プラットフォーム考慮事項
- **クロスプラットフォーム対応**: 全プラットフォームで同じ体験
- **プラットフォーム最適化**: 各プラットフォームの特性を活用
- **段階的展開**: 特定プラットフォームから開始して順次拡大

### 3.3 ストーリー分割・細分化

#### 分割基準
- **プラットフォーム別**: Android版、iOS版、Web版など
- **機能別**: 作成・編集・削除・検索など
- **ユーザータイプ別**: 一般ユーザー・管理者など
- **複雑度別**: 基本機能・高度な機能

#### 分割例
```
大きなストーリー:
「ユーザーはマルチプラットフォームで商品を管理したい」

↓ 分割後:

PBI-001: Android版商品一覧表示機能
PBI-002: Android版商品登録機能
PBI-003: iOS版商品一覧表示機能
PBI-004: iOS版商品登録機能
PBI-005: Web版商品管理画面
```

## 4. 受け入れ条件の定義

### 4.1 受け入れ条件作成原則

#### SMART原則
- **Specific（具体的）**: 明確で具体的な条件
- **Measurable（測定可能）**: 客観的に判定できる
- **Achievable（達成可能）**: 技術的に実現可能
- **Relevant（関連性）**: ユーザーストーリーに直結
- **Time-bound（期限付き）**: 完了時期が明確

### 4.2 受け入れ条件のテンプレート

#### Given-When-Then形式
```
Given [前提条件]
When [実行するアクション]
Then [期待される結果]
```

#### 標準的な受け入れ条件項目
- **機能要件**
  - 基本動作の確認
  - エラーハンドリング
  - 異常系の動作
  
- **非機能要件**
  - パフォーマンス（応答時間、処理能力）
  - ユーザビリティ（操作性、アクセシビリティ）
  - セキュリティ（認証、データ保護）

- **プラットフォーム要件**
  - 各プラットフォームでの動作確認
  - レスポンシブデザイン
  - プラットフォーム固有機能の利用

### 4.3 プラットフォーム別受け入れ条件

#### Android
- マテリアルデザインガイドライン準拠
- 各種画面サイズ・密度での表示確認
- Androidバージョン互換性
- 権限リクエストの適切な処理

#### iOS
- Human Interface Guidelines準拠
- iPhone・iPad対応（該当する場合）
- iOSバージョン互換性
- App Store審査基準への準拠

#### Web
- 主要ブラウザでの動作確認
- レスポンシブデザイン
- アクセシビリティ（WCAG準拠）
- SEO対応（必要に応じて）

#### Desktop
- OS別動作確認（Windows/Mac/Linux）
- 各種画面解像度での表示確認
- キーボードショートカット
- ネイティブOS機能との連携

#### Server
- APIレスポンス仕様
- 処理性能・スループット
- セキュリティ（認証・認可）
- 監視・ログ出力

## 5. 見積もりと優先度付け

### 5.1 見積もり手法

#### ストーリーポイント見積もり
- **フィボナッチ数列**: 1, 2, 3, 5, 8, 13
- **相対的見積もり**: 過去のストーリーとの比較
- **プランニングポーカー**: チーム全体での合意形成

#### プラットフォーム別複雑度考慮
```
基準ポイント × プラットフォーム係数
- Android のみ: 1.0
- iOS のみ: 1.0  
- Web のみ: 1.0
- Desktop のみ: 1.0
- Server のみ: 1.0
- Android + iOS: 1.5
- 全プラットフォーム: 2.0-3.0
```

#### 技術的複雑度の考慮要因
- **新技術の学習コスト**
- **プラットフォーム間の差異**
- **外部システム連携の複雑さ**
- **UI/UXの複雑さ**
- **テスト範囲の広さ**

### 5.2 優先度付けフレームワーク

#### ビジネス価値 vs 実装複雑度マトリックス
```
高価値・低複雑度: 最優先（Quick Wins）
高価値・高複雑度: 重要（Major Projects）
低価値・低複雑度: 余裕があれば（Fill-ins）
低価値・高複雑度: 後回し（Questionable）
```

#### 優先度評価項目
- **ビジネス価値** (1-10点)
  - ユーザー影響度
  - 収益への貢献
  - 戦略的重要度
  
- **緊急度** (1-10点)
  - リリース期限
  - 依存関係
  - 市場要求

- **技術的実現性** (1-10点)
  - 実装難易度
  - チームのスキル適合度
  - 技術的リスク

### 5.3 リリース計画への組み込み

#### エピック・リリース計画
- **エピック**: 関連するPBIのグループ
- **リリース**: 機能的にまとまったPBIの集合
- **スプリント**: 開発可能なPBIの組み合わせ

#### プラットフォーム展開戦略
- **段階的展開**: 特定プラットフォームから開始
- **同時展開**: 全プラットフォーム同時リリース
- **コア機能優先**: 共通機能を先行実装

## 6. PBIドキュメントの作成

### 6.1 テンプレート活用

既存の `templates/pbi-template.md` を基準として、以下の情報を充実させます。

#### 必須記入項目の詳細化

**概要セクション**
- ビジネス背景と目的
- 解決したい課題
- 期待される成果・効果

**ユーザーストーリーセクション**  
- プライマリユーザー
- セカンダリユーザー（該当する場合）
- 複数のシナリオ（必要に応じて）

**受け入れ条件セクション**
- 機能要件（Given-When-Then形式推奨）
- 非機能要件
- プラットフォーム要件

**技術的詳細セクション**
- アーキテクチャへの影響
- 使用技術・ライブラリ
- データモデル変更
- API仕様変更

### 6.2 プラットフォーム影響範囲の詳細化

```markdown
### 影響範囲
- [x] Android - 新機能追加、UI変更
- [x] iOS - 新機能追加、UI変更
- [ ] Web - 対象外
- [ ] Desktop - 対象外  
- [x] Server - 新API追加、DB変更
```

#### プラットフォーム固有考慮事項
```markdown
### プラットフォーム固有要件
#### Android
- 最小SDKバージョン: API 24
- 特別な権限: CAMERA, LOCATION
- 使用ライブラリ: CameraX, Maps SDK

#### iOS
- 最小iOSバージョン: iOS 14.0
- 必要な權限: Camera, Location
- 使用フレームワーク: AVFoundation, MapKit
```

### 6.3 PBI作成チェックリスト

#### 作成完了チェック項目
- [ ] ユーザーストーリーがINVEST原則を満たしている
- [ ] 受け入れ条件がSMART原則に従っている
- [ ] プラットフォーム影響範囲が明確
- [ ] 見積もりが適切（1-13ポイント範囲）
- [ ] 依存関係が特定されている
- [ ] 技術的リスクが評価されている
- [ ] ステークホルダーの承認が得られている

## 7. レビューと承認プロセス

### 7.1 レビューステップ

#### Stage 1: 内部レビュー
**参加者**: プロダクトオーナー、技術リード
**目的**: 要件の妥当性、技術的実現可能性の確認
**所要時間**: 1-2日

**チェックポイント**
- ユーザーストーリーの明確性
- 受け入れ条件の完全性
- 技術的実現可能性
- 見積もりの妥当性

#### Stage 2: ステークホルダーレビュー
**参加者**: 要求元ステークホルダー、プロダクトオーナー
**目的**: 要件理解の相違確認、優先度の最終調整
**所要時間**: 2-3日

**確認事項**
- 要件の解釈に相違がないか
- 受け入れ条件が期待通りか
- 優先度・期限に変更がないか
- 追加要件・制約がないか

#### Stage 3: 開発チームレビュー
**参加者**: 開発チーム全体、プロダクトオーナー、技術リード
**目的**: 実装アプローチの確認、見積もりの検証
**所要時間**: 1日（チーム会議）

**議論内容**
- 実装アプローチの合意
- タスク分解の妥当性
- 技術的課題・リスクの共有
- 見積もりの最終調整

### 7.2 承認フロー

#### 承認段階と承認者
```
PBI作成 → 内部レビュー → ステークホルダー承認 → 開発チーム承認 → バックログ追加
    ↓           ↓              ↓                 ↓              ↓
   作成者      技術リード     要求元SH           開発チーム      PO
```

#### 承認基準
- **技術的実現可能性**: 現在の技術スタックで実現可能
- **リソース可用性**: 見積もり工数に対してリソース確保可能
- **ビジネス価値**: 投資対効果が合理的
- **品質基準**: 品質要件を満たせる設計

### 7.3 フィードバック・修正プロセス

#### フィードバック管理
- **修正要求の記録**: 誰が、いつ、何を要求したか
- **修正理由の明文化**: なぜ修正が必要なのか
- **影響範囲の評価**: 修正による見積もり・期限への影響

#### 修正対応フロー
```
フィードバック受領 → 影響分析 → 修正実施 → 再レビュー → 承認
```

#### エスカレーション基準
以下の場合は上位管理者へのエスカレーションを実施：
- ステークホルダー間で要件に関する意見相違
- 技術的制約により大幅な仕様変更が必要
- 見積もりが当初予想の200%を超過
- 依存関係により他PBIへの重大な影響

### 7.4 品質保証

#### PBI品質チェックリスト
- [ ] **明確性**: 曖昧な表現がなく、誰が読んでも同じ理解
- [ ] **完全性**: 実装に必要な情報がすべて含まれている
- [ ] **一貫性**: 他のPBIや要件と矛盾がない
- [ ] **テスト可能性**: 受け入れ条件が客観的に検証可能
- [ ] **追跡可能性**: ビジネス要求からPBIまでの関連が明確

#### 継続的改善
- **PBIレトロスペクティブ**: 完了後の振り返り
- **プロセス改善**: ワークフローの継続的な見直し
- **テンプレート更新**: 学習した内容の反映
- **チーム能力向上**: 見積もり精度の向上

## 8. ツール・テンプレート

### 8.1 使用ツール
- **ドキュメント管理**: Git + Markdown
- **コラボレーション**: プロジェクト管理ツール（Jira、GitHub Issues など）
- **コミュニケーション**: Slack、Teams など

### 8.2 テンプレート一覧
- `templates/pbi-template.md`: PBI基本テンプレート
- `templates/requirement-analysis.md`: 要件分析シート（このワークフローで追加検討）
- `templates/review-checklist.md`: レビューチェックリスト（このワークフローで追加検討）

### 8.3 プロセス運用指標
- **PBI作成時間**: ヒアリングから承認まで平均日数
- **修正率**: 初回レビューでの修正要求発生率
- **見積もり精度**: 実績工数との差異
- **ステークホルダー満足度**: 完了PBIに対する評価

---

## まとめ

このワークフローにより、ステークホルダーの真のニーズを的確に把握し、Kotlin Multiplatformプロジェクトの特性を考慮した高品質なPBIを効率的に作成できます。プロセスの継続的改善を通じて、チーム全体のプロダクト開発能力向上を図っていきましょう。

**重要**: このワークフローは生きたドキュメントです。プロジェクトの成長とチームの学習に応じて、定期的に見直し・更新を行ってください。